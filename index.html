<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ethics Survey</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: auto;
      padding: 20px;
    }
    label {
      display: block;
      margin-top: 15px;
    }
    input,
    select,
    textarea {
      width: 100%;
      padding: 8px;
      box-sizing: border-box;
    }
    .timestamp {
      font-size: 0.9em;
      color: #555;
    }
    button {
      margin-top: 20px;
      padding: 10px 20px;
    }
    #status {
      margin-top: 20px;
      font-weight: bold;
    }
  </style>
</head>
<body>

  <h2>Ethics Survey</h2>

  <!-- Timestamp Display -->
  <div class="timestamp">
    Timestamp: <span id="displayTimestamp"></span>
    <input type="hidden" name="timestamp" id="timestampInput" />
  </div>

  <!-- Survey Form -->
  <form id="surveyForm">

    <label>Company Sector<br>
      <input type="text" name="companySector" required />
    </label>

    <label>Job Role<br>
      <input type="text" name="jobRole" required />
    </label>

    <label>Do you feel fairly treated?<br>
      <select name="fairTreatment" required>
        <option value="">Select</option>
        <option value="Yes">Yes</option>
        <option value="No">No</option>
      </select>
    </label>

    <label>Stress Level (1-5)<br>
      <input type="number" name="stressLevel" min="1" max="5" required />
    </label>

    <label>Is workload transparent?<br>
      <select name="workloadTransparent" required>
        <option value="">Select</option>
        <option value="Yes">Yes</option>
        <option value="No">No</option>
      </select>
    </label>

    <label>Have you faced bias at work?<br>
      <select name="facedBias" required>
        <option value="">Select</option>
        <option value="Yes">Yes</option>
        <option value="No">No</option>
      </select>
    </label>

    <label>Trust in AI-based HR tools (1-5)<br>
      <input type="number" name="trustAIHR" min="1" max="5" required />
    </label>

    <label>Satisfaction with Ethical Practices (1-5)<br>
      <input type="number" name="ethicalSatisfaction" min="1" max="5" required />
    </label>

    <label>What bias have you faced at work? (Skip if none)<br>
      <input type="text" name="biasFaced" />
    </label>

    <label>In what way does your work environment make you feel unappreciated?<br>
      <textarea name="feelUnappreciated" rows="4"></textarea>
    </label>

    <button type="submit">Submit Response</button>

  </form>

  <!-- Status Message -->
  <div id="status"></div>

  <!-- JavaScript Submission Handler -->
  <script>
    // Generate current timestamp
    function getCurrentTimestamp() {
      const options = {
        year: 'numeric', month: 'short', day: 'numeric',
        hour: '2-digit', minute: '2-digit', second: '2-digit',
        hour12: false
      };
      const now = new Date();
      return now.toLocaleString('en-US', options);
    }

    // Set timestamp in hidden input and display span
    const timestampDisplay = document.getElementById("displayTimestamp");
    const timestampInput = document.getElementById("timestampInput");
    const formattedTime = getCurrentTimestamp();
    timestampDisplay.textContent = formattedTime;
    timestampInput.value = formattedTime;

    // Handle form submission
    const form = document.getElementById('surveyForm');
    const status = document.getElementById('status');

    form.addEventListener('submit', function(e) {
      e.preventDefault();

      const formData = {};
      new FormData(form).forEach((value, key) => formData[key] = value);

      const submitBtn = form.querySelector("button");
      submitBtn.disabled = true;
      submitBtn.textContent = "Submitting...";

      fetch('https://script.google.com/macros/s/AKfycby0lvr0mhQx-EtPZLeILFOC3NKpQ_rI24qOkS9CkSkFz4R991kWwWXg--Y_N9nEEU9R/exec ', {
        method: 'POST',
        body: JSON.stringify(formData),
        headers: { 'Content-Type': 'application/json' }
      })
      .then(response => response.json())
      .then(data => {
        if (data.result === "success") {
          status.textContent = 'Thank you! Your response has been recorded.';
          status.style.color = 'green';
          form.reset();
        } else {
          throw new Error("Submission failed");
        }
      })
      .catch(error => {
        console.error('Error:', error);
        status.textContent = 'There was an error submitting your response.';
        status.style.color = 'red';
      })
      .finally(() => {
        submitBtn.disabled = false;
        submitBtn.textContent = 'Submit Response';
      });
    });
  </script>

</body>
</html>
